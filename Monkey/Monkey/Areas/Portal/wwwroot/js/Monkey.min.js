"use strict";window.Monkey={isDebug:!0,constant:{momentDateTimeFormat:"DD/MM/YYYY hh:mm:ss A",momentDateFormat:"DD/MM/YYYY"},initToolTip:function(){$('[data-toggle="tooltip"]').tooltip()},initConfirmDialog:function(){$('[data-plugin="confirm"]').click(function(){var n=$(this);swal({title:n.data("confirm-title"),text:n.data("confirm-message"),type:"warning",showCancelButton:!0,confirmButtonClass:"btn-pink",confirmButtonText:"Yes",cancelButtonText:"No",closeOnConfirm:!1,closeOnCancel:!1},function(t){if(t){var i=n.data("confirm-yes-callback");eval(i);swal({title:n.data("confirm-yes-title")||"Deleted!",text:n.data("confirm-yes-message")||"Delete Successful",type:"success",timer:2e3})}else swal({title:n.data("confirm-no-title")||"Canceled",text:n.data("confirm-no-message"),type:"error",timer:2e3})})})},setupAjax:function(){$.ajaxSetup({headers:{"X-XSRF-TOKEN":$("[name=ape]").val()},type:"POST",cache:!1,error:function(n){if(console.log("[Request Error]",n),n.status===401||n.status===403)window.location.href="/Portal/Auth";else if(n.status===404)window.location.href="/Portal";else try{if(n.status===0)return;var t=JSON.parse(n.responseText);t.code?window.Monkey.notify("Error",t.message,"error"):window.Monkey.notify("Error","System error, please try again or contact administrator!","error")}catch(i){window.Monkey.notify("Error","System error, please try again or contact administrator!","error")}}})},notify:function(n,t,i,r){r=r||{};n=n||undefined;t=t||"";i=i||"info";r.progressBar=r.progressBar||!0;r.timeOut=r.timeOut||5e3;r.preventDuplicates=r.preventDuplicates||!1;r.positionClass=r.positionClass||"toast-bottom-right";switch(i){case"success":toastr.success(t,n,r);break;case"warning":toastr.warning(t,n,r);break;case"error":toastr.error(t,n,r);break;case"info":toastr.info(t,n,r);break;default:toastr.info(t,n,r)}},initSlidePanel:function(){$('[data-toggle="slidePanel"]').click(function(){var n=$(this);$.slidePanel.show({url:n.data("url"),settings:{method:"GET",cache:!1}},{direction:"right"})})},initAutoRenderSlug:function(){$('[data-bind-type="slug"]').on("keyup blur",function(){var n=$(this),t=$(n.data("bind-to"));t.val(n.val().genSlug())})},notificationHub:{connection:null,connect:function(){window.Monkey.notificationHub.connection=new signalR.HubConnection("/hub/portal/notification");window.Monkey.notificationHub.connection.on("refreshNotification",function(){window.Monkey.notificationHub.refreshNotification();return});window.Monkey.notificationHub.connection.on("setNotification",function(n){window.Monkey.notificationHub.setItems(n);return});window.Monkey.notificationHub.connection.start().then(function(){window.Monkey.isDebug===!0&&console.log("[Socket] connected to notification hub");window.Monkey.notificationHub.refreshNotification();return}).catch(function(n){window.Monkey.isDebug===!0&&console.log("[Socket] connection error:"+n);return})},refreshNotification:function(){window.Monkey.notificationHub.connection.invoke("GetAllAsync");window.Monkey.isDebug===!0&&console.log("refresh notification")},setTotal:function(n){var t=parseInt(n);isNaN(t)||t<0||($(".notification-total").html(t),t<=0?$(".notification-total").parent().css("visibility","hidden").css("display","none"):$(".notification-total").parent().css("visibility","").css("display",""))},updateHeight:function(){for(var t,i=0,n=0;n<5;n++){if($(".notification-item").length<=n)break;i+=$($(".notification-item")[n]).height()}$("#notification-list").parent().height(i);t=$("#notification-list").parents(".list-group");t&&t.data("asScrollable")&&t.data("asScrollable").update()},onOpenNotification:function(){setTimeout(function(){window.Monkey.notificationHub.updateHeight();window.Monkey.notificationHub.maskAllAsRead()},10)},getItemHtml:function(n){var t;return n?(t=n.type==="Success"?"bg-green-600":n.type==="Warning"?"bg-orange-600":n.type==="Error"?"bg-red-600":n.type==="Critical"?"bg-purple-600":"bg-blue-600",'<a class="list-group-item dropdown-item notification-item" href="'+n.url+'" role="menuitem"><div class="media">    <div class="pr-10">        <i class="icon md-receipt '+t+' white icon-circle verical-icon-center" aria-hidden="true"><\/i>    <\/div>    <div class="media-body">       <h6 class="media-heading notification-title">'+n.message+'<\/h6>      <time class="media-meta" datetime="${itemData.createdTime}">'+window.Monkey.formatDateTime(n.createdTime)+"<\/time>    <\/div><\/div><\/a>"):""},data:{},setItems:function(n){var t,i;if(window.Monkey.notificationHub.data=n,$("#notification-list").empty(),n&&n.items){for(t=0;t<n.items.length;t++)i=window.Monkey.notificationHub.getItemHtml(n.items[t]),$("#notification-list").append($(i));window.Monkey.notificationHub.setTotal(n.TotalUnRead);window.Monkey.notificationHub.updateHeight()}},maskAllAsRead:function(){var n=window.Endpoint.notification.maskAllAsReadEndpoint;$.ajax({url:n,method:"PUT",contentType:"text/plain",success:function(){window.Monkey.notificationHub.setTotal(0)}});console.log(n)}},abbreviateNumber:function(n){var t=Math.log10(n)/3|0;if(t==0)return n;var i=["","k","m","g","t","p","e"][t],r=Math.pow(10,t*3),u=n/r;return u.toFixed(1)+i},decodeHtml:function(n){return $("<div/>").html(n).text()},openLink:function(n,t){if(t&&t===!0){var i=window.open(n,"_blank");i.focus()}else window.open(n,"_self")},addListener_Keyboard_Enter:function(n,t,i){var r=n.split(",");$.each(r,function(n,r){$(r).keydown(function(n){n.which===13&&$(t).trigger(i)})})},formatDateTime:function(n){return moment(n).format(window.Monkey.constant.momentDateTimeFormat)},formatDate:function(n){return moment(n).format(window.Monkey.constant.momentDateFormat)},rgbToHex:function(n,t,i){return"#"+(16777216+(n<<16)+(t<<8)+i).toString(16).slice(1)},initAutoBindColorDominant:function(){$('[data-bind-type="color-dominant"]').change(function(){var n=$(this),t=n.data("bind-to");window.Monkey.bindColorDominant(this,$(t))})},autoBindColorDominant:function(n,t){$(n).change(function(){window.Monkey.bindColorDominant(this,$(t))})},bindColorDominant:function(n,t){var i=new FileReader;i.onload=function(n){var i=new Image,r;i.onload=function(){var r=new ColorThief,n=r.getColor(i),u=window.Monkey.rgbToHex(n[0],n[1],n[2]);t.asColorPicker("val",u)};r=n.target.result;i.src=r};i.readAsDataURL(n.files[0])},renderGoogleMap:function(n,t,i,r){var f=new window.GMaps({div:n,lat:i.val(),lng:r.val()}),u,e=new google.maps.InfoWindow({});window.GMaps.geocode({address:t.val().trim(),callback:function(n,o){var s,h,c;o==="OK"?(s=n[0],e.setContent(s.formatted_address),t.val(s.formatted_address),h=s.geometry.location,i.val(h.lat()),r.val(h.lng()),f.setCenter(h.lat(),h.lng()),c={lat:h.lat(),lng:h.lng(),draggable:!0,animation:google.maps.Animation.DROP},u=f.addMarker(c),google.maps.event.addListener(u,"dragend",function(n){i.val(n.latLng.lat());r.val(n.latLng.lng());window.GMaps.geocode({latLng:u.getPosition(),callback:function(n){s=n[0];e.setContent(s.formatted_address);e.open(f,u);t.val(s.formatted_address)}})}),e.open(f,u)):(t.val(""),i.val(""),r.val(""))}})},initDropify:function(){var n=$('[data-plugin="dropify"]');$.each(n,function(n,t){var r=$(t).dropify(),i=r.data("dropify");i.destroy();i.settings.messages={"default":$(t).data("message-default")||"Drag and drop a file here or click",replace:$(t).data("message-error")||"Drag and drop or click to replace",remove:$(t).data("message-remove")||"Remove",error:$(t).data("message-replace")||"Ooops, something wrong happended."};i.settings.tpl={wrap:'<div class="dropify-wrapper"><\/div>',loader:'<div class="dropify-loader"><\/div>',message:'<div class="dropify-message"><span class="file-icon" /> <p>'+i.settings.messages.default+"<\/p><\/div>",preview:'<div class="dropify-preview"><span class="dropify-render"><\/span><div class="dropify-infos"><div class="dropify-infos-inner"><p class="dropify-infos-message">'+i.settings.messages.replace+"<\/p><\/div><\/div><\/div>",filename:'<p class="dropify-filename"><span class="dropify-filename-inner"><\/span><\/p>',clearButton:'<button type="button" class="dropify-clear">'+i.settings.messages.remove+"<\/button>",errorLine:'<p class="dropify-error">'+i.settings.messages.error+"<\/p>",errorsContainer:'<div class="dropify-errors-container"><ul><\/ul><\/div>'};i.init()})},clearDropify:function(n,t,i,r){var e,f,u;e=$(n).dropify();f=e.data("dropify");f.resetPreview();f.clearElement();i&&i.length>0&&$(i).val("");u=$(n).data("bind-to");u&&u.length>0&&$(u).val("");t&&$(t).val(!0);r&&typeof r=="function"&&r()},initAutoDecimalFormat:function(){var n=$('[data-plugin="decimal-format"]');$.each(n,function(n,t){$(t).mask("#,##0.00",{reverse:!0})})},initDateTimePicker:function(){var n=$('[data-plugin="datetime-picker"]');$.each(n,function(n,t){$(t).datetimepicker({format:window.Monkey.constant.momentDateTimeFormat})})},initTimePicker:function(){var n=$('[data-plugin="time-picker"]');$.each(n,function(n,t){$(t).datetimepicker({format:window.Monkey.constant.momentTimeFormat})})},dataTableAmountRender:function(n){return window.Monkey.abbreviateNumber(n)},dataTableImageRender:function(n){return n&&n.trim().length>0?"<img class='menu-img' src="+n+" />":""},dataTableDrawCallBack:function(){window.Monkey.initToolTip();window.Monkey.initConfirmDialog()},dataTableResponsiveCallBack:function(n,t,i){var f=i.reduce(function(n,t){return t===!1?n+1:n},0),e=$("#"+n.currentTarget.id),r=e.find("thead").find("tr"),u=r[r.length-1];f>0?$(u).addClass("hidden"):$(u).removeClass("hidden")},resetFormValidation:function(n){n=n||$("form")[0];event.preventDefault();var t=$(n);t.validate().resetForm();t.valid()},initAutoResetFormValidation:function(){var n=$('[data-reset-form-validation="true"]');$.each(n,function(n,t){$(t).on("keyup blur",function(){var n=$($(t).closest("form")[0]),i=n.attr("id")||n.attr("class");window.Monkey.resetFormValidation(i)})})},GenerateGuid:function(){return window.Monkey.s4()+window.Monkey.s4()+"-"+window.Monkey.s4()+"-"+window.Monkey.s4()+"-"+window.Monkey.s4()+"-"+window.Monkey.s4()+window.Monkey.s4()+window.Monkey.s4()},s4:function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)},initialMenubar:function(){if(typeof Storage!="undefined"){$("#toggleMenubar").on("click",function(){var n=$("body").hasClass("site-menubar-fold");n===!0?localStorage.setItem("menu-bar-class","site-menubar-unfold"):localStorage.setItem("menu-bar-class","site-menubar-fold")});localStorage.getItem("menu-bar-class")&&($("body").removeClass("site-menubar-fold"),$("body").removeClass("site-menubar-unfold"),$("body").addClass(localStorage.getItem("menu-bar-class")))}}};$(document).ready(function(){window.Monkey.setupAjax();window.Monkey.initToolTip();window.Monkey.initConfirmDialog();window.Monkey.initSlidePanel();window.Monkey.notificationHub.connect();window.Monkey.initAutoRenderSlug();window.Monkey.initAutoBindColorDominant();window.Monkey.initAutoDecimalFormat();window.Monkey.initDateTimePicker();window.Monkey.initTimePicker();window.Monkey.initDropify();window.Monkey.initAutoResetFormValidation();window.Monkey.initialMenubar()});String.prototype.preventInjection=function(){return this.replace(/</g,"&lt;").replace(/>/g,"&gt;")};String.prototype.genSlug=function(){var t,n;return t=this,n=t.toLowerCase(),n=n.replace(/á|à|ả|ạ|ã|ă|ắ|ằ|ẳ|ẵ|ặ|â|ấ|ầ|ẩ|ẫ|ậ/gi,"a"),n=n.replace(/é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ/gi,"e"),n=n.replace(/i|í|ì|ỉ|ĩ|ị/gi,"i"),n=n.replace(/ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/gi,"o"),n=n.replace(/ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự/gi,"u"),n=n.replace(/ý|ỳ|ỷ|ỹ|ỵ/gi,"y"),n=n.replace(/đ/gi,"d"),n=n.replace(/c#/gi,"c-sharp"),n=n.replace(/\`|\~|\!|\@|\#|\||\$|\%|\^|\&|\*|\(|\)|\+|\=|\,|\.|\/|\?|\>|\<|\'|\"|\:|\;|_/gi,""),n=n.replace(/ /gi,"-"),n=n.replace(/\-\-\-\-\-/gi,"-"),n=n.replace(/\-\-\-\-/gi,"-"),n=n.replace(/\-\-\-/gi,"-"),n=n.replace(/\-\-/gi,"-"),n="@"+n+"@",n.replace(/\@\-|\-\@|\@/gi,"")};Array.prototype.remove=function(){for(var n,t=arguments,i=t.length,r;i&&this.length;)for(n=t[--i];(r=this.indexOf(n))!==-1;)this.splice(r,1);return this};Array.prototype.contains=function(n){return this.indexOf(n)>-1};