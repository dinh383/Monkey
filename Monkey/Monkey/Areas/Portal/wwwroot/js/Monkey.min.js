window.monkey={initToolTip:function(){$('[data-toggle="tooltip"]').tooltip()},initConfirmDialog:function(){$('[data-plugin="confirm"]').click(function(){var n=$(this);swal({title:n.data("confirm-title"),text:n.data("confirm-message"),type:"warning",showCancelButton:!0,confirmButtonClass:"btn-pink",confirmButtonText:"Yes",cancelButtonText:"No",closeOnConfirm:!1,closeOnCancel:!1},function(t){if(t){var i=n.data("confirm-yes-callback");eval(i);swal(n.data("confirm-yes-title")||"Deleted!",n.data("confirm-yes-message")||"Delete Successful","success")}else swal(n.data("confirm-no-title")||"Cancelled",n.data("confirm-no-message"),"error")})})},setupAjax:function(){$.ajaxSetup({headers:{"X-XSRF-TOKEN":$("[name=ape]").val()},type:"POST",cache:!1,error:function(n){if(console.log("[Request Error]",n),n.status===401||n.status===403)window.location.href="/Portal/Auth";else if(n.status===404)window.location.href="/Portal";else try{var t=JSON.parse(n.responseText);t.code?monkey.notify("Error",t.message,"error"):monkey.notify("Error","System error, please try again or contact administrator!","error")}catch(i){monkey.notify("Error","System error, please try again or contact administrator!","error")}}})},notify:function(n,t,i,r){r=r||{};n=n||undefined;t=t||"";i=i||"info";r.progressBar=r.progressBar||!0;r.timeOut=r.timeOut||5e3;r.preventDuplicates=r.preventDuplicates||!1;r.positionClass=r.positionClass||"toast-bottom-right";switch(i){case"success":toastr.success(t,n,r);break;case"warning":toastr.warning(t,n,r);break;case"error":toastr.error(t,n,r);break;case"info":toastr.info(t,n,r);break;default:toastr.info(t,n,r)}},initSlidePanel:function(){$('[data-toggle="slidePanel"]').click(function(){var n=$(this);$.slidePanel.show({url:n.data("url"),settings:{method:"GET",cache:!1}},{direction:"right"})})},renderSlugAuto:function(n,t){n.on("keyup",function(){t.val(n.val().genSlug())})},notificationHub:{connection:null,connect:function(){monkey.notificationHub.connection=new signalR.HubConnection("/portal/notification");monkey.notificationHub.connection.on("addNotification",n=>{monkey.notificationHub.addItem(n)});monkey.notificationHub.connection.on("setNotifications",n=>{monkey.notificationHub.setItems(n)});monkey.notificationHub.connection.start().then(()=>{console.log("[Socket] connected to notification hub"),monkey.notificationHub.receiveAllNotification()}).catch(n=>{console.log(`[Socket] connection error: ${n}`)})},sendUsers:function(n,t){monkey.notificationHub.connection.invoke("sendNotificationToSubjectsAsync",n,t)},sendPermissions:function(n,t){monkey.notificationHub.connection.invoke("sendNotificationToPermissionsAsync",n,t)},receiveAllNotification:function(){monkey.notificationHub.connection.invoke("receiveAllNotificationAsync")},setTotal:function(n){var t=parseInt(n);t===NaN||t<0||($(".notification-total").html(t),t<=0?$(".notification-total").parent().css("visibility","hidden").css("display","none"):$(".notification-total").parent().css("visibility","").css("display",""))},updateHeight:function(){for(var t,i=0,n=0;n<5;n++){if($(".notification-item").length<=n)break;i+=$($(".notification-item")[n]).height()}$("#notification-list").parent().height(i);t=$("#notification-list").parents(".list-group");t&&t.data("asScrollable")&&t.data("asScrollable").update()},onOpenNotification:function(){setTimeout(function(){monkey.notificationHub.updateHeight()},1)},updateTotal:function(){var n=0;$.each(monkey.notificationHub.items,function(t,i){i.isRead===!1&&n++});monkey.notificationHub.setTotal(n)},getItemHtml:function(n){return` <a class="list-group-item dropdown-item notification-item" href="${n.url}" role="menuitem">
                            <div class="media">
                                <div class="pr-10">
                                    <i class="icon md-receipt bg-red-600 white icon-circle" aria-hidden="true"></i>
                                </div>
                                <div class="media-body">
                                    <h6 class="media-heading">${n.message}</h6>
                                    <time class="media-meta" datetime="${n.createdTime}">${monkey.formatDateTime(n.createdTime)}</time>
                                </div>
                            </div>
                        </a>`},items:[],setItems:function(n){$("#notification-list").empty();for(var t=0;t<n.length;t++)monkey.notificationHub.addItem(n[t])},addItem:function(n){monkey.notificationHub.items.push(n);monkey.notificationHub.updateTotal();var t=monkey.notificationHub.getItemHtml(n);$("#notification-list").prepend($(t));monkey.notificationHub.updateHeight()}},abbreviateNumber:function(n){var t=Math.log10(n)/3|0;if(t==0)return n;var i=["","k","m","g","t","p","e"][t],r=Math.pow(10,t*3),u=n/r;return u.toFixed(1)+i},decodeHtml:function(n){return $("<div/>").html(n).text()},openLink:function(n,t){if(t&&t===!0){var i=window.open(n,"_blank");i.focus()}else window.open(n,"_self")},addListener_Keyboard_Enter:function(n,t,i){var r=n.split(",");$.each(r,function(n,r){$(r).keydown(function(n){n.which===13&&$(t).trigger(i)})})},formatDateTime:function(n){return moment(n).format(window.constants.dateTimeFormat)}};$(function(){monkey.setupAjax();monkey.initToolTip();monkey.initConfirmDialog();monkey.initSlidePanel();monkey.notificationHub.connect()});String.prototype.preventInjection=function(){return this.replace(/</g,"&lt;").replace(/>/g,"&gt;")};String.prototype.genSlug=function(){var t,n;return t=this,n=t.toLowerCase(),n=n.replace(/á|à|ả|ạ|ã|ă|ắ|ằ|ẳ|ẵ|ặ|â|ấ|ầ|ẩ|ẫ|ậ/gi,"a"),n=n.replace(/é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ/gi,"e"),n=n.replace(/i|í|ì|ỉ|ĩ|ị/gi,"i"),n=n.replace(/ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/gi,"o"),n=n.replace(/ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự/gi,"u"),n=n.replace(/ý|ỳ|ỷ|ỹ|ỵ/gi,"y"),n=n.replace(/đ/gi,"d"),n=n.replace(/c#/gi,"c-sharp"),n=n.replace(/\`|\~|\!|\@|\#|\||\$|\%|\^|\&|\*|\(|\)|\+|\=|\,|\.|\/|\?|\>|\<|\'|\"|\:|\;|_/gi,""),n=n.replace(/ /gi,"-"),n=n.replace(/\-\-\-\-\-/gi,"-"),n=n.replace(/\-\-\-\-/gi,"-"),n=n.replace(/\-\-\-/gi,"-"),n=n.replace(/\-\-/gi,"-"),n="@"+n+"@",n.replace(/\@\-|\-\@|\@/gi,"")};Array.prototype.remove=function(){for(var n,t=arguments,i=t.length,r;i&&this.length;)for(n=t[--i];(r=this.indexOf(n))!==-1;)this.splice(r,1);return this};Array.prototype.contains=function(n){return this.indexOf(n)>-1};